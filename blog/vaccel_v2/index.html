<!DOCTYPE html>
<!-- This site was created with Hugo Blox. https://hugoblox.com -->
<!-- Last Published: February 19, 2026 --><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Hugo Blox Builder 5.9.7" />
  

  
  












  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.26c458e6907dc03073573976b7f4044e.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.4/css/academicons.min.css" integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css" integrity="" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.d4f5bfbf6342fcc4a6bb8d18586cb58a.css" />

  
  
  

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  



























  
  
  






  <meta name="author" content="Charalampos Mainas" />





  

<meta name="description" content="In our previous post we spoke about the potential solutions for
deploying serverless offerings with hardware acceleration support. With the
increasing adoption of the serverless and FaaS paradigms, providers will need
to offer some form of hardware acceleration semantics." />



<link rel="alternate" hreflang="en-us" href="/blog/vaccel_v2/" />
<link rel="canonical" href="/blog/vaccel_v2/" />



  <link rel="manifest" href="/manifest.webmanifest" />



<link rel="icon" type="image/png" href="/media/icon_hu_ea0c30c6d45d84f4.png" />
<link rel="apple-touch-icon" type="image/png" href="/media/icon_hu_86daab30bf3ca8be.png" />

<meta name="theme-color" content="#1565c0" />










  
  






<meta property="twitter:card" content="summary" />

  <meta property="twitter:site" content="@GetResearchDev" />
  <meta property="twitter:creator" content="@GetResearchDev" />
<meta property="twitter:image" content="/media/logo_hu_f553cb9eef83bc41.png" />



  

<meta property="og:type" content="website" />
<meta property="og:site_name" content="Nubificus" />
<meta property="og:url" content="/blog/vaccel_v2/" />
<meta property="og:title" content="Hardware acceleration in the Age of Functions (vol II) | Nubificus" />
<meta property="og:description" content="In our previous post we spoke about the potential solutions for
deploying serverless offerings with hardware acceleration support. With the
increasing adoption of the serverless and FaaS paradigms, providers will need
to offer some form of hardware acceleration semantics." /><meta property="og:image" content="/media/logo_hu_f553cb9eef83bc41.png" /><meta property="og:locale" content="en-us" />

  
    <meta
      property="article:published_time"
      content="2020-12-04T14:14:04&#43;01:00"
    />
  
  
    <meta property="article:modified_time" content="2020-12-04T14:14:04&#43;01:00">
  







  




  
  
  

  
  

  
  
  
  
  
    <script src="https://cdn.jsdelivr.net/gh/osano/cookieconsent@3.1.1/build/cookieconsent.min.js" integrity="sha512-yXXqOFjdjHNH1GND+1EO0jbvvebABpzGKD66djnUfiKlYME5HGMUJHoCaeE4D5PTG2YsSJf6dwqyUUvQvS0vaA==" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/osano/cookieconsent@3.1.1/build/cookieconsent.min.css" integrity="sha512-LQ97camar/lOliT/MqjcQs5kWgy6Qz/cCRzzRzUCfv0fotsCTC9ZHXaPQmJV8Xu/PVALfJZ7BDezl5lW3/qBxg==" crossorigin="anonymous">
  
  <script>
  window.addEventListener("load", function(){
    window.cookieconsent.initialise({
      "palette": {
        "popup": {
          "background": "#1565c0",
          "text": "rgb(255, 255, 255)"
        },
        "button": {
          "background": "rgb(255, 255, 255)",
          "text": "#1565c0"
        }
      },
      "theme": "classic",
      "content": {
        "message": "This website uses cookies to ensure you get the best experience on our website.",
        "dismiss": "Got it!",
        "link": "Learn more",
        "href": "https://www.cookiesandyou.com"
      }
    })});
  </script>



  
  <title>Hardware acceleration in the Age of Functions (vol II) | Nubificus</title>

  
  
  
  











</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="f3941a44f94156d560cff458014acee9" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.9e4214442a7711d35691acd58f6f6361.js"></script>

  




  <div class="page-header header--fixed">
  
  
  
  
  


<style>
.navbar-logo {
    height: 50px;
    display: flex;
    align-items: center;
}

.navbar-logo img {
    max-height: 45px;
    width: auto;
    display: block;
}

.navbar-logo .logo-dark {
    display: none;
}

body.colorscheme-dark .navbar-logo .logo-light,
body.dark .navbar-logo .logo-light {
    display: none;
}

body.colorscheme-dark .navbar-logo .logo-dark,
body.dark .navbar-logo .logo-dark {
    display: block;
}

.navbar-logo.logo-nubis,
.navbar-logo.logo-nubificus {
    display: none;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    var host = window.location.hostname;
    var isNubis = (host === 'nubis-pc.eu' || host === 'www.nubis-pc.eu');
    var cls = isNubis ? 'logo-nubis' : 'logo-nubificus';
    document.querySelectorAll('.navbar-logo.' + cls).forEach(function(el) {
        el.style.display = 'flex';
    });
    document.querySelectorAll('[data-brand]').forEach(function(el) {
        var role = el.getAttribute('data-brand');
        if (isNubis) {
            el.textContent = (role === 'primary') ? 'Nubis' : 'Nubificus';
        } else {
            el.textContent = (role === 'primary') ? 'Nubificus' : 'Nubis';
        }
    });
});
</script>










  


<header>
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      
      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">
          <div class="navbar-logo logo-nubificus">
            <img class="logo-light" src="/media/logo-nubificus_hu_5bae3e7b5bc92c43.png" alt="Nubificus">
            <img class="logo-dark" src="/media/logo-nubificus-dark_hu_1887b26263e462ca.png" alt="Nubificus">
          </div>
          <div class="navbar-logo logo-nubis">
            <img class="logo-light" src="/media/logo-nubis.png" alt="Nubis PC">
            <img class="logo-dark" src="/media/logo-nubis-dark.png" alt="Nubis PC">
          </div>
        </a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">
          <div class="navbar-logo logo-nubificus">
            <img class="logo-light" src="/media/logo-nubificus_hu_5bae3e7b5bc92c43.png" alt="Nubificus">
            <img class="logo-dark" src="/media/logo-nubificus-dark_hu_1887b26263e462ca.png" alt="Nubificus">
          </div>
          <div class="navbar-logo logo-nubis">
            <img class="logo-light" src="/media/logo-nubis.png" alt="Nubis PC">
            <img class="logo-dark" src="/media/logo-nubis-dark.png" alt="Nubis PC">
          </div>
        </a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          

          

          
          
          
          

          
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/"><span>Home</span></a>
          </li>

          
          

          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Research</span><span class="caret"></span>
            </a>
            <div class="dropdown-menu">
              
                <a class="dropdown-item" href="/projects/"><span>Projects</span></a>
              
                <a class="dropdown-item" href="/publication"><span>Publications</span></a>
              
            </div>
          </li>

          
          

          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Solutions</span><span class="caret"></span>
            </a>
            <div class="dropdown-menu">
              
                <a class="dropdown-item" href="/solutions/edgelink/"><span>edgeLink</span></a>
              
                <a class="dropdown-item" href="/solutions/urunc/"><span>urunc</span></a>
              
                <a class="dropdown-item" href="/solutions/vaccel/"><span>vAccel</span></a>
              
            </div>
          </li>

          
          

          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Feed</span><span class="caret"></span>
            </a>
            <div class="dropdown-menu">
              
                <a class="dropdown-item" href="/post"><span>News</span></a>
              
                <a class="dropdown-item" href="/event"><span>Events</span></a>
              
            </div>
          </li>

          
          

          

          
          
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link  active" href="/blog"><span>Blog</span></a>
          </li>

          
          

          
          <li class="nav-item dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>About</span><span class="caret"></span>
            </a>
            <div class="dropdown-menu">
              
                <a class="dropdown-item" href="/people"><span>People</span></a>
              
                <a class="dropdown-item" href="/contact"><span>Contact</span></a>
              
            </div>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        

        
        
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>
<script>
document.addEventListener('DOMContentLoaded', function () {
  
  var dropdowns = document.querySelectorAll('.navbar-nav .nav-item.dropdown');
  dropdowns.forEach(function (dd) {
    dd.addEventListener('mouseenter', function () {
      
      dropdowns.forEach(function (other) {
        if (other !== dd) {
          other.classList.remove('show');
          var m = other.querySelector('.dropdown-menu');
          if (m) m.classList.remove('show');
        }
      });
      
      dd.classList.add('show');
      var menu = dd.querySelector('.dropdown-menu');
      if (menu) menu.classList.add('show');
    });
    dd.addEventListener('mouseleave', function () {
      dd.classList.remove('show');
      var menu = dd.querySelector('.dropdown-menu');
      if (menu) menu.classList.remove('show');
    });
  });
});
</script>


  </div>

  <div class="page-body">
    
    
    

    <article class="article">

  <div class="article-container">
    <a class="blog-back-link" href="javascript:void(0)" onclick="blogGoBack()">
      <i class="fas fa-arrow-left"></i> Back to Blog
    </a>
  </div>

  













  

  
  
  
<div class="article-container pt-3">
  <h1>Hardware acceleration in the Age of Functions (vol II)</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Dec 4, 2020
  </span>
  

  

  

  
  
  
  

  
  

</div>

    





  
</div>



  <div class="article-container">

    <div class="article-style">
      <p>In our <a href="https://blog.cloudkernels.net/posts/vaccel/" target="_blank" rel="noopener">previous post</a> we spoke about the potential solutions for
deploying serverless offerings with hardware acceleration support. With the
increasing adoption of the serverless and FaaS paradigms, providers will need
to offer some form of hardware acceleration semantics.</p>
<p>For some time now, Amazon has <a href="https://github.com/firecracker-microvm/firecracker/issues/1179" target="_blank" rel="noopener">identified</a> this as a &ldquo;compelling use
case&rdquo; for their AWS Firecracker hypervisor which powers the Amazon Lambda
service. What is more, they identify traditional techniques for GPU support in
VMs such as GPU passthrough comes with limitations and significantly increases
the attack surface of the hypervisor.</p>
<p>As an alternative to passing through the accelerator device inside the guest,
paravirtual interfaces can expose hardware acceleration capabilities inside
the VM with minimal overhead and offering a simple user interface for
offloading code to the host for acceleration.</p>
<p>In fact, such interfaces already exist. <code>virtio-crypto</code> is an example, where
the guest VM uses a simple crypto API while the actual computation is
offloaded, through the paravirtual driver, to the host.</p>
<p>We believe that the same paradigm can be applied to any kind of computation
that can benefit from acceleration. Whether that is crypto operations, Machine
Learning or linear algebra operators, the workflow from the point of view of
the developer these days is the same; You will use a framework such as
cryptodev, Jetson Inference or the BLAS library, to write your applications and
you will not deal with the low-level complexities of the actual accelerator.
Moreover, that workflow should not be different whether your application runs
on baremetal or inside a VM.</p>
<p>In the rest of this post we present  <em>vAccel</em>, an acceleration framework that
enables <strong>portable</strong> and <strong>hardware agnostic</strong> acceleration for cloud
and edge applications.</p>
<h2 id="vaccel-design">vAccel design</h2>
<p>In simple terms, vAccel is an acceleration API. It offers support for a set of
operators that commonly use hardware acceleration to increase performance,
such as machine learning and linear algebra operators.</p>
<p>The API is implemented by <em>VaccelRT</em> a thin and efficient runtime system that links
against the user application and is responsible for dispatching operations to
the relevant hardware accelerators. The interaction with the hardware itself is
mediated by plugins which implement the API for the specific hardware
accelerator.</p>
<p>This design is driven by our requirements for high degree of portability, an
application that consumes the vAccel API can run without modification or even
re-compilation to any platform for which there is suitable back-end plugin.</p>
<p>In fact, this opens up the way to enable the vAccel API inside a VM guest. The missing
bits are a virtio driver that implements the vAccel API and a backend plugin that
speaks with the virtio device. Once you have this components in place, you can
run your existing vAccel application inside a VM, just by using the virtio-plugin at
runtime.</p>
<p>















<figure  id="figure-vaccelrt">
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="/images/vaccel_v2/vaccelrt.png#center" alt="vAccel runtime" loading="lazy" data-zoomable /></div>
  </div><figcaption>
      VaccelRT
    </figcaption></figure>
</p>
<h2 id="vaccel-support-in-aws-firecracker">vAccel support in AWS Firecracker</h2>
<p>Once we implemented the frontend vAccel-virtio driver and virtio plugin for VaccelRT,
we need a hypervisor to test this on. We already showed, in the previous post some
initial vAccel results with QEMU as the target hypervisor. In this post, we will focus
on AWS Firecracker.</p>
<p>AWS Firecracker has been designed having in mind really small boot times and small attack
surface, which makes it a compelling choice for cloud and edge deployments.
Moreover, it powers up Lambda, Amazon&rsquo;s serverless platform, which we see as a
paradigm for which vAccel&rsquo;s hardware abstraction level is a perfect fit.</p>
<p>AWS Firecracker already implements virtio backend drivers for net, block and vsock. That
was good news for us, we have all the required virtio machinery. All we had to do, was
add a new device for vAccel and link the hypervisor with VaccelRT.</p>
<p>The last bit required us to create the necessary Rust bindings for calling C from AWS Firecracker
which is written in Rust. This was actually a good exercise for us, since we plan to anyway
provide bindings for the vAccel API in more high-level languages.</p>
<p>With all the components in place our stack looks like this:</p>
<p>















<figure  id="figure-vaccel-e2e">
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="/images/vaccel_v2/vaccele2e.png#center" alt="vAccel VM execution" loading="lazy" data-zoomable /></div>
  </div><figcaption>
      vaccel-e2e
    </figcaption></figure>
</p>
<p>The user application is consumes the vAccel API and links against VaccelRT. Inside the VM
the application uses the vAccel-virtio backend plugin. When a vAccel function is called, the
plugin will offload the request to <code>/dev/accel</code> device which is the interface of the virtio
driver. Next, the virtio driver will forward the request to the vAccel-enabled AWS Firecracker
instance which will the host-residing VaccelRT. Finally, in the host side, VaccelRT will use
one of the available plugins, to execute the operation on the hardware accelerator.</p>
<p>But how does this perform?</p>
<p>We first grabbed a copy of jetson-inference, a rich repo full of ML inference models and example applications based on TensorRT. We patched it to be able to run on an x86 GPU (we had an NVIDIA RTX 2060 SUPER handy), and we built the vAccelRT backend for an image classification operation. To compare vAccel on AWS firecracker we patched the example imagenet-console application to properly calculate the time of execution and to account for more than 1 iteration. The average execution time for image classification on two sets of Image files (set &ldquo;*_0.jpg&rdquo; and &ldquo;*_1.jpg) are shown below:</p>
<p>















<figure  id="figure-vaccel-bf-0">
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="/images/vaccel_v2/vaccel_bf_0.png#center" alt="vAccel VM execution" loading="lazy" data-zoomable /></div>
  </div><figcaption>
      vaccel-bf-0
    </figcaption></figure>
</p>
<p>The set above is sorted by the overhead percentage (GUEST vs HOST), while the set below, is sorted by Image size (in KB). One thing to note is that on all cases, the overhead of running an image classification operation in the guest compared to the host is less than 5%.</p>
<p>















<figure  id="figure-vaccel-bf-1">
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="/images/vaccel_v2/vaccel_bf_1.png#center" alt="vAccel VM execution" loading="lazy" data-zoomable /></div>
  </div><figcaption>
      vaccel-bf-1
    </figcaption></figure>
</p>
<h2 id="putting-it-all-together">Putting it all together</h2>
<p>So, are you brave (or curious) enough to try it out yourself ? Full disclosure, vAccel is WiP, in terms of software development terms, the project should be considered in a pre-alpha phase. However, since we think the idea is useful, there might be someone willing to try it out. So here we go:</p>
<p>TL;DR
The easy way to try vAccel on AWS Firecracker is to run the docker container bundled with all necessary libraries/tools etc. The only prerequisite is [Docker][https://github.com/NVIDIA/nvidia-container-runtime] &amp; nvidia-container-runtime[https://github.com/NVIDIA/nvidia-container-runtime] installed.</p>
<p>To fire a VM up try running:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">docker run -e LD_LIBRARY_PATH=/usr/local/lib -e VACCEL_BACKENDS=/usr/local/lib/libvaccel-jetson.so --rm -it --gpus all --privileged nubificus/jetson-runtime
</span></span></code></pre></div><p>Now what the above command does is the following:</p>
<ul>
<li>sets up a couple of env vars to let the container know where to find the necessary libraries</li>
<li>runs in a privileged mode so that /dev/kvm is available to the container instance (we need to boot a VM in there ;))</li>
<li>provides access to the GPU from the container.</li>
</ul>
<p>The entrypoint for the above container image (<code>nubificus/jetson-runtime</code>) simply starts a firecracker VM with a pre-built kernel &amp; rootfs.img, available <a href="https://github.com/nubificus/fc-x86-guest-build" target="_blank" rel="noopener">here</a>. This repository contains the dockerfile from which these binaries have been produced. You can download ready-made binaries from the <a href="https://github.com/nubificus/fc-x86-guest-build/releases/latest" target="_blank" rel="noopener">releases</a> page.</p>
<p>If (for any reason) you want to try out jetson-inference, without the AWS Firecracker VM boot, then just run the container with /bin/bash as an entrypoint, using the following command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">docker run --network=host --rm -it --gpus all --privileged -v nubificus/jetson-runtime /bin/bash
</span></span></code></pre></div><h3 id="host">Host</h3>
<p>The current available version of vAccelRT supports the jetson-inference plugin. Adding a new plugin is as easy as linking with vAccelRT and writing the glue code in the plugin directory &ndash; more information should be available in the coming weeks!</p>
<p>To use this plugin, the Host machine should have an NVIDIA GPU (supporting CUDA), the relevant drivers installed, as well as <a href="https://github.com/dusty-nv/jetson-inference" target="_blank" rel="noopener">jetson-inference</a> installed.</p>
<p>The next step is to build &amp; install <a href="https://github.com/cloudkernels/vaccelrt" target="_blank" rel="noopener">vAccelRT</a>, the glue that ties everything together. You can build it from source, or just install the binaries available from the <a href="https://github.com/cloudkernels/vaccelrt/releases/latest" target="_blank" rel="noopener">releases</a> page. Make sure you specify <code>LD_LIBRARY_PATH</code> to the folder where libvaccel.so is located, as well as to choose the necessary backend by setting <code>VACCEL_BACKENDS</code> to <code>libvaccel-jetson.so</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">export</span> <span class="n">LD_LIBRARY_PATH</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span>
</span></span><span class="line"><span class="cl"><span class="k">export</span> <span class="n">VACCEL_BACKENDS</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">libvaccel</span><span class="o">-</span><span class="n">jetson</span><span class="o">.</span><span class="n">so</span>
</span></span></code></pre></div><h3 id="vm">VM</h3>
<p>To run a vAccel-enabled VM, we need four basic components:</p>
<ul>
<li>the AWS firecracker VMM (with the vAccel backend patch) <a href="https://github.com/cloudkernels/firecracker" target="_blank" rel="noopener">github</a> <a href="https://github.com/cloudkernels/firecracker/releases/latest" target="_blank" rel="noopener">releases</a></li>
<li>a firecracker guest Linux kernel supporting modules + the virtio-accel module <a href="https://github.com/nubificus/fc-x86-guest-build" target="_blank" rel="noopener">github</a> <a href="https://github.com/nubificus/fc-x86-guest-build/releases/latest" target="_blank" rel="noopener">releases</a></li>
<li>the vAccel runtime system (vAccelRT) for the Host and the guest <a href="https://github.com/cloudkernels/vaccelrt" target="_blank" rel="noopener">github</a> <a href="https://github.com/cloudkernels/vaccelrt/releases/latest" target="_blank" rel="noopener">releases</a></li>
</ul>
<p>To facilitate the process of packing all these software components, we include links to binaries built from the respective github repositories.</p>
<p>Grab, or build <code>vmlinux</code> &amp; the <code>rootfs.img</code> from the links above, and use a template config for firecracker like the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">	&#34;boot-source&#34;: {
</span></span><span class="line"><span class="cl">		&#34;kernel_image_path&#34;: &#34;vmlinux&#34;,
</span></span><span class="line"><span class="cl">		&#34;boot_args&#34;: &#34;console=ttyS0 reboot=k panic=1 pci=off loglevel=0 root=/dev/vda quiet&#34;
</span></span><span class="line"><span class="cl">	},
</span></span><span class="line"><span class="cl">	&#34;drives&#34;: [
</span></span><span class="line"><span class="cl">		{
</span></span><span class="line"><span class="cl">			&#34;drive_id&#34;: &#34;rootfs&#34;,
</span></span><span class="line"><span class="cl">			&#34;path_on_host&#34;: &#34;rootfs.img&#34;,
</span></span><span class="line"><span class="cl">			&#34;is_root_device&#34;: true,
</span></span><span class="line"><span class="cl">			&#34;is_read_only&#34;: false
</span></span><span class="line"><span class="cl">		}
</span></span><span class="line"><span class="cl">	],
</span></span><span class="line"><span class="cl">	&#34;network-interfaces&#34;: [
</span></span><span class="line"><span class="cl">	{
</span></span><span class="line"><span class="cl">		&#34;iface_id&#34;: &#34;eth0&#34;,
</span></span><span class="line"><span class="cl">		&#34;guest_mac&#34;: &#34;AA:FC:00:00:00:01&#34;,
</span></span><span class="line"><span class="cl">		&#34;host_dev_name&#34;: &#34;tap&#34;
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">	],
</span></span><span class="line"><span class="cl">	&#34;crypto&#34;: {
</span></span><span class="line"><span class="cl">		&#34;crypto_dev_id&#34;: &#34;vaccel0&#34;,
</span></span><span class="line"><span class="cl">		&#34;host_crypto_dev&#34;: &#34;/dev/vaccel0&#34;
</span></span><span class="line"><span class="cl">	},
</span></span><span class="line"><span class="cl">	&#34;machine-config&#34;: {
</span></span><span class="line"><span class="cl">		&#34;vcpu_count&#34;: 1,
</span></span><span class="line"><span class="cl">		&#34;mem_size_mib&#34;: 1024,
</span></span><span class="line"><span class="cl">		&#34;ht_enabled&#34;: false
</span></span><span class="line"><span class="cl">	}
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></div><p>Make sure vmlinux, rootfs.img are in the same directory as the invocation of the firecracker command. Also, ensure that you have set <code>LD_LIBRARY_PATH</code> and <code>VACCEL_BACKENDS</code> correctly, and that you&rsquo;ve downloaded the ML networks needed for inference. This step can be done using <a href="https://github.com/dusty-nv/jetson-inference/blob/master/tools/download-models.sh" target="_blank" rel="noopener">this script</a>. Just get this script and run:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">./</span><span class="n">download</span><span class="o">-</span><span class="n">models</span><span class="o">.</span><span class="n">sh</span> <span class="n">NO</span>
</span></span></code></pre></div><p>and the models will be placed by default at <code>../data/networks</code>. Change the path in the script if you need to. For the AWS Firecracker backend to work, we need the models in the same directory as the invocation of the firecracker binary, in a folder called networks.</p>
<p>Now, we&rsquo;re ready to fire up our VM:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">firecracker --api-sock /tmp/fc.sock --config-file config_vaccel.json --seccomp-level 0
</span></span></code></pre></div><p>aaand we get the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">2020-12-04T14:39:02.363414625 [anonymous-instance:WARN:src/devices/src/legacy/i8042.rs:126] Failed to trigger i8042 kbd interrupt (disabled by guest OS)
</span></span><span class="line"><span class="cl">2020-12-04T14:39:02.369542154 [anonymous-instance:WARN:src/devices/src/legacy/i8042.rs:126] Failed to trigger i8042 kbd interrupt (disabled by guest OS)
</span></span><span class="line"><span class="cl">SELinux:  Could not open policy file &lt;= /etc/selinux/targeted/policy/policy.32:  No such file or directory
</span></span><span class="line"><span class="cl">[    0.970330] systemd[1]: Failed to find module &#39;autofs4&#39;
</span></span><span class="line"><span class="cl">[UNSUPP] Starting of Arbitrary Exec…Automount Point not supported.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Ubuntu 20.04.1 LTS vaccel-guest.nubificus.co.uk ttyS0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">vaccel-guest login: 
</span></span></code></pre></div><p>Some harmless messages and a login prompt! Try <code>root</code> for username (no password).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">vaccel-guest login: root
</span></span><span class="line"><span class="cl">Welcome to Ubuntu 20.04.1 LTS (GNU/Linux 4.20.0 x86_64)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> * Documentation:  https://help.ubuntu.com
</span></span><span class="line"><span class="cl"> * Management:     https://landscape.canonical.com
</span></span><span class="line"><span class="cl"> * Support:        https://ubuntu.com/advantage
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">This system has been minimized by removing packages and content that are
</span></span><span class="line"><span class="cl">not required on a system that users do not log into.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">To restore this content, you can run the &#39;unminimize&#39; command.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The programs included with the Ubuntu system are free software;
</span></span><span class="line"><span class="cl">the exact distribution terms for each program are described in the
</span></span><span class="line"><span class="cl">individual files in /usr/share/doc/*/copyright.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
</span></span><span class="line"><span class="cl">applicable law.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">root@vaccel-guest:~#
</span></span></code></pre></div><p>Bear in mind, the rootfs.img is based on docker hub&rsquo;s ubuntu latest.</p>
<p>Now lets do some image classification! Try running the following:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">root@vaccel-guest:~# ./classify images/airplane_1.jpg 1
</span></span><span class="line"><span class="cl">Initialized session with id: 1
</span></span><span class="line"><span class="cl">Image size: 115835B
</span></span><span class="line"><span class="cl">classification tags: 21.973% warplane, military plane
</span></span></code></pre></div><p>The first time the execution might take longer, but any consecutive run will be significantly faster. This is because the acceleration backend (jetson-inference) needs to examine the hardware available, generate and load the necessary components for the model to run correctly.</p>
<p>That&rsquo;s it! you just ran an image classification example for a JPG image, in an AWS Firecracker VM, talking vAccelRT, which, in turn, forwards this request to AWS Firecracker vAccel backend, calling vAccelRT, jetson-inference, talking to the GPU and voila!</p>
<h2 id="future-steps">Future steps</h2>
<p>Argh! you made it this far? :D If you enjoyed playing with hardware
acceleration &amp; Firecracker stay tuned to enjoy some more of this on aarch64
devices (yeap, the NVIDIA Jetson Nano!). Last but not least, we are in the
process of integrating vAccel-enabled AWS Firecracker instances to k8s and k3s
to facilitate deployment and scaling.</p>
<p>Give us a shout at <a href="mailto:team@cloudkernels.net">team@cloudkernels.net</a> if you liked it, or visit the <a href="https://vaccel.org" target="_blank" rel="noopener">vAccel</a> website and drop us a note at <a href="mailto:vaccel@nubificus.co.uk">vaccel@nubificus.co.uk</a> for more info!</p>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/vaccel/">Vaccel</a>
  
  <a class="badge badge-light" href="/tag/aws-firecracker/">AWS Firecracker</a>
  
  <a class="badge badge-light" href="/tag/virtio/">VirtIO</a>
  
  <a class="badge badge-light" href="/tag/serverless/">Serverless</a>
  
</div>



<div class="share-box">
  <ul class="share">
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=%2Fblog%2Fvaccel_v2%2F&amp;text=Hardware&#43;acceleration&#43;in&#43;the&#43;Age&#43;of&#43;Functions&#43;%28vol&#43;II%29" target="_blank" rel="noopener" class="share-btn-twitter" aria-label="twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=%2Fblog%2Fvaccel_v2%2F&amp;t=Hardware&#43;acceleration&#43;in&#43;the&#43;Age&#43;of&#43;Functions&#43;%28vol&#43;II%29" target="_blank" rel="noopener" class="share-btn-facebook" aria-label="facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
        
      
      <li>
        <a href="mailto:?subject=Hardware%20acceleration%20in%20the%20Age%20of%20Functions%20%28vol%20II%29&amp;body=%2Fblog%2Fvaccel_v2%2F" target="_blank" rel="noopener" class="share-btn-email" aria-label="envelope">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=%2Fblog%2Fvaccel_v2%2F&amp;title=Hardware&#43;acceleration&#43;in&#43;the&#43;Age&#43;of&#43;Functions&#43;%28vol&#43;II%29" target="_blank" rel="noopener" class="share-btn-linkedin" aria-label="linkedin-in">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="whatsapp://send?text=Hardware&#43;acceleration&#43;in&#43;the&#43;Age&#43;of&#43;Functions&#43;%28vol&#43;II%29%20%2Fblog%2Fvaccel_v2%2F" target="_blank" rel="noopener" class="share-btn-whatsapp" aria-label="whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=%2Fblog%2Fvaccel_v2%2F&amp;title=Hardware&#43;acceleration&#43;in&#43;the&#43;Age&#43;of&#43;Functions&#43;%28vol&#43;II%29" target="_blank" rel="noopener" class="share-btn-weibo" aria-label="weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>
























  </div>
</article>

<script>
function blogGoBack() {
  if (document.referrer && document.referrer.indexOf('/blog') !== -1) {
    history.back();
  } else {
    window.location.href = '\/blog\/';
  }
}
</script>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  












  
  
  
  
  













  
  
  

  
  
    
  
  
    
  

  

  
  <p class="powered-by copyright-license-text">
    © 2026 Nubificus LTD. This work is licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank">CC BY NC ND 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
        <i class="fab fa-creative-commons-nc fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-nd fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>





  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Hugo Blox Builder</a> — the free, <a href="https://github.com/HugoBlox/hugo-blox-builder" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  


<script src="/js/vendor-bundle.min.5faf09821dbe513ca103e87bafd52766.js"></script>




  

  
  

  






  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js" integrity="" crossorigin="anonymous"></script>



































<script id="page-data" type="application/json">{"use_headroom":true}</script>


  <script src="/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js" type="module"></script>










<script src="/en/js/wowchemy.min.e166a4f802c5f09237cc72919197d83b.js"></script>



  <script src="/js/wowchemy-map.a26e9d2f7238ba5b868384f1c5bc6477.js" type="module"></script>




  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <pre><code></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/wowchemy-publication.9c0e895144aef5a693008b5c5d450147.js" type="module"></script>


















</body>
</html>
